#!/bin/sh
usermod -aG libvirt "$(whoami)"
chmod -R 777 /home/gabi

add_nodisplay() {
  file="$1"
  sed -i '/^NoDisplay=/d' "$file"
  echo 'NoDisplay=true' >> "$file"
}

add_nodisplay /usr/share/applications/gnome-language-selector.desktop
add_nodisplay /usr/share/applications/gnome-session-properties.desktop

sed -i '/^NoDisplay=true/d; /^Type=Application/a NoDisplay=true' /usr/share/applications/org.gnome.TextEditor.desktop
apt install -y apt-transport-https curl
curl -fsSL https://brave-browser-apt-release.s3.brave.com/brave-core.asc | gpg --dearmor | tee /usr/share/keyrings/brave-browser-archive-keyring.gpg > /dev/null
echo "deb [signed-by=/usr/share/keyrings/brave-browser-archive-keyring.gpg] https://brave-browser-apt-release.s3.brave.com/ stable main" | tee /etc/apt/sources.list.d/brave-browser-release.list

apt update -y
apt install -y software-properties-common dpkg wget

add-apt-repository multiverse -y
dpkg --add-architecture i386
apt update -y

apt install -y steam virt-manager gnome-shell-extension-manager libgdk-pixbuf2.0-0 plasma-discover flatpak brave-browser

apt upgrade -y

flatpak remote-add --if-not-exists flathub https://dl.flathub.org/repo/flathub.flatpakrepo
flatpak install -y flathub org.vinegarhq.Sober

apt remove -y firefox || true
snap remove firefox || true

apt-get update && apt-get install -y default-jre
curl -fsSL -O https://launcher.mojang.com/download/Minecraft.deb
dpkg -i Minecraft.deb; apt-get install -f; rm Minecraft.deb
rm -f /usr/share/applications/minecraft-launcher.desktop

mkdir -p ~/.local/share/applications
cat > ~/.local/share/applications/minecraft-launcher.desktop <<EOF
[Desktop Entry]
Name=Minecraft Launcher
Comment=Launch Minecraft
Exec=env GTK_IM_MODULE=none QT_IM_MODULE=none XMODIFIERS= __GLFW_IM_MODULE=none minecraft-launcher
Icon=minecraft-launcher
Terminal=false
Type=Application
Categories=Game;Application;
StartupWMClass=minecraft-launcher
EOF
